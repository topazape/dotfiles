#!/bin/sh

layout_poetry() {
  if [[ ! -f pyproject.toml ]]; then
    log_error 'No pyproject.toml found.  Use `poetry new` or `poetry init` to create one first.'
    exit 2
  fi
  poetry run true

  export VIRTUAL_ENV=$(poetry env info --path)
  export POETRY_ACTIVE=1
  PATH_add "$VIRTUAL_ENV/bin"
}

use_jupyter() {
	export IPYTHONDIR="$VIRTUAL_ENV/.ipython"
	export JUPYTER_CONFIG_DIR="$VIRTUAL_ENV/.jupyter"
}

use_rdkit() {
	export LD_LIBRARY_PATH="$VIRTUAL_ENV/lib":"$HOME/.linuxbrew/lib":$LD_LIBRARY_PATH
}

use_gpu() {
	export CUDA_ROOT="/usr/local/cuda"
	export PATH="/usr/local/cuda/bin":$PATH
	export CUDA_VISIBLE_DEVICES=$1
	export LD_LIBRARY_PATH="/usr/local/cuda/lib64":$LD_LIBRARY_PATH
}

use_tensorflow() {
	export CUDA_ROOT="/usr/local/cuda"
	export PATH="/usr/local/cuda-10.1/bin":$PATH
	export CUDA_VISIBLE_DEVICES=$1
	export LD_LIBRARY_PATH="/usr/local/cuda-10.1/lib64":"/usr/local/cuda-10.1/extras/CUPTI/lib64":"/usr/local/cuda-10.1/TensorRT-6.0.1.5/lib":$LD_LIBRARY_PATH
}
